"use strict";var PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",Module=angular.module("datePicker");Module.constant("dateTimeConfig",{template:function(e,i){return"<div "+(i?'id="'+i+'" ':"")+'date-picker="'+e.ngModel+'" '+(e.view?'view="'+e.view+'" ':"")+(e.maxView?'max-view="'+e.maxView+'" ':"")+(e.maxDate?'max-date="'+e.maxDate+'" ':"")+(e.autoClose?'auto-close="'+e.autoClose+'" ':"")+(e.template?'template="'+e.template+'" ':"")+(e.minView?'min-view="'+e.minView+'" ':"")+(e.minDate?'min-date="'+e.minDate+'" ':"")+(e.partial?'partial="'+e.partial+'" ':"")+(e.step?'step="'+e.step+'" ':"")+(e.onSetDate?'date-change="'+e.onSetDate+'" ':"")+(e.ngModel?'ng-model="'+e.ngModel+'" ':"")+(e.firstDay?'first-day="'+e.firstDay+'" ':"")+(e.timezone?'timezone="'+e.timezone+'" ':"")+'class="date-picker-date-time"></div>'},format:"YYYY-MM-DD HH:mm",views:["date","year","month","hours","minutes"],autoClose:!1,position:"relative"}),Module.directive("dateTimeAppend",function(){return{link:function(e,i){i.bind("click",function(){i.find("input")[0].focus()})}}}),Module.directive("dateTime",["$compile","$document","$filter","dateTimeConfig","$parse","datePickerUtils",function(e,i,t,n,a,o){var r=i.find("body"),l=t("mFormat");return{require:"ngModel",scope:!0,link:function(i,t,m,s){function d(e){return l(e,$,Y)}function u(e){if(e.length===$.length)return e}function f(e){P=e,m.minDate=e?e.format():e,T=moment.isMoment(e)}function c(e){I=e,m.maxDate=e?e.format():e,A=moment.isMoment(e)}function p(){w=n.template(m)}function g(e){e.stopPropagation(),s.$pristine&&(s.$dirty=!0,s.$pristine=!1,t.removeClass(PRISTINE_CLASS).addClass(DIRTY_CLASS),x&&x.$setDirty(),s.$render())}function D(){k&&(k.remove(),k=null),b&&(b.remove(),b=null)}function v(){if(!k){if(k=e(w)(i),i.$digest(),z||(i.$on("setDate",function(e,i,t){g(e),R&&R(m.ngModel,i),S&&C[C.length-1]===t&&D()}),i.$on("hidePicker",function(){t.triggerHandler("blur")}),i.$on("$destroy",D),z=!0),"absolute"===V){var n=t[0].getBoundingClientRect(),a=n.height||t[0].offsetHeight;k.css({top:n.top+a+"px",left:n.left+"px",display:"block",position:V}),r.append(k)}else b=angular.element("<div date-picker-wrapper></div>"),t[0].parentElement.insertBefore(b[0],t[0]),b.append(k),k.css({top:t[0].offsetHeight+"px",display:"block"});k.bind("mousedown",function(e){e.preventDefault()})}}var w,$=m.format||n.format,x=t.inheritedData("$formController"),C=a(m.views)(i)||n.views.concat(),h=m.view||C[0],M=C.indexOf(h),S=m.autoClose?a(m.autoClose)(i):n.autoClose,k=null,y=t[0].id,V=m.position||n.position,b=null,P=null,T=null,I=null,A=null,Y=m.timezone||!1,H=o.eventIsForPicker,R=null,z=!1;M===-1&&C.splice(M,1),C.unshift(h),s.$formatters.push(d),s.$parsers.unshift(u),angular.isDefined(m.minDate)&&(f(o.findParam(i,m.minDate)),s.$validators.min=function(e){return!T||moment.isMoment(e)&&(P.isSame(e)||P.isBefore(e))}),angular.isDefined(m.maxDate)&&(c(o.findParam(i,m.maxDate)),s.$validators.max=function(e){return!A||moment.isMoment(e)&&(I.isSame(e)||I.isAfter(e))}),angular.isDefined(m.dateChange)&&(R=o.findFunction(i,m.dateChange)),y&&i.$on("pickerUpdate",function(e,i,t){if(H(i,y))if(k);else{var a=!1;angular.isDefined(t.minDate)&&(f(t.minDate),a=!0),angular.isDefined(t.maxDate)&&(c(t.maxDate),a=!0),angular.isDefined(t.minView)&&(m.minView=t.minView),angular.isDefined(t.maxView)&&(m.maxView=t.maxView),m.view=t.view||m.view,a&&s.$validate(),angular.isDefined(t.format)&&($=m.format=t.format||n.format,s.$modelValue=-1),p()}}),t.bind("focus",v),t.bind("blur",D),p()}}}]);